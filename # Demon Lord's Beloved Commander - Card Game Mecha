# Demon Lord's Beloved Commander - Card Game Mechanics
**Version:** v1.13 – Integrated Balance Tweaks: Echo max3/Tap Persistent, Upkeep Scry3 if Cascade=0, Life35 Start, Hand Temp15 on Draw, Upkeep Converts Cost 1 Mana  
**Format Inspiration:** Slay the Spire (full refresh mana, no lands) + Commander singleton hybrid.  
**Deck Size:** 60 cards total (commander separate in command zone; editable in deckbuilder menu when not in combat). Snappy 5-10 min duels.  
**Deckbuilding:** Up to **2 copies** of any card (Echo Crystals max 3 total in deck for ramp reliability).  
**Goal:** Reduce opponent's life from **35** to 0 (or mill deckout).

## Core Rules
- **Starting Life:** **35** each.
- **Starting Hand:** 7 cards.
- **Mulligan:** Once only — shuffle deck, draw 6 cards (no further).
- **Hand Size Limit:** Max 13 cards.
  - **Draw Resolution (Turn Draw or Effects):** Temporarily allow up to **15 cards**. Immediately discard down to 13 if exceeded (player chooses which).
  - **End Step Cleanup:** Discard to 13 if >13 from effects (player chooses).
- **Draw:** 1 card/turn (**skipped if at 13 pre-draw**).
- **Commander Rules:** Waifu in command zone (1-of singleton). Recast tax: +2 mana per prior cast (cast to battlefield like creature).
- **Sorcery-Speed Only:** All cards/abilities activate in *your* main phase (no interrupts/counters/stacks).
- **Turn Structure:** 
  1. **Untap** (untap tapped cards/abilities).
  2. **Upkeep** (full mana refresh; cascade triggers **+ Scry3 if cascade=0**).
  3. **Draw** (1 card; temp to 15, discard excess to 13 immediately if needed).
  4. **Main Phase** (play cards from hand, activate abilities/commander).
  5. **Combat** (targeted blocking).
  6. **End Step** (cleanup; final discard to 13).

## Mana System (Full Refresh – Explosive Starts, Starts at 3)
- **Every Turn:** Refreshes to full current max_mana (UI: orbs fill instantly). **Starts at 3 max.**
- **Upkeep Refresh:** current_mana = max_mana.
- **Max 10:** Ramp cards/upgrades add +1 permanent (e.g., story romance, duel wins).
- **Echo Crystals** (0-cost artifacts, **max 3 in deck**): Play to battlefield (neutral, no cascade change). **Tap: Add 1 mana** (usable in main phase). **Untaps in upkeep.** **When played: If cascade >=3, permanently +1 max_mana.**

## Core Target Modes (used by most effects)
| Target Mode              | Description                                      | Common Effects That Use It                     |
|--------------------------|--------------------------------------------------|------------------------------------------------|
| Player (self)            | Affects the owner                                | DrawCards, GainLife, AddCascade (positive)     |
| Player (opponent)        | Affects the enemy player                         | DealDamage (direct), ForceDiscard, Mill, LoseLife |
| Creature (any)           | Target one creature (yours or opponent's)        | DealDamage, DestroyTarget, BuffPowerToughness  |
| Creature (yours)         | Target one of your creatures                     | Equip, AuraAttach, AddKeyword                  |
| Creature (opponent)      | Target one enemy creature                        | DestroyTarget, ReducePowerToughness, ForceDiscard |
| All creatures            | Affects every creature on board                  | DestroyAll, BuffPowerToughness (mass)          |
| All your creatures       | Mass effect on your side                         | Mass buff, AddKeyword (all yours)              |
| All opponent creatures   | Mass effect on enemy side                        | Mass debuff, DestroyAll (opponent only)        |
| Random opponent creature | Hits one random enemy creature                   | Chaos/ping effects                             |

## Elemental Cascade Meter (Single Chaining Momentum – Mana Cost Adds)
**Each player has one cascade meter:** Single value (0-10) + current Element (Fire/Holy/Arcane/Nature/Shadow/None). Builds by chaining; switches less punishing via mana cost scaling.

- **Elements (5 Total – Balanced Coverage):**
  | Element  | Vibe                  | Primary Waifu     | Secondary Waifu   |
  |----------|-----------------------|-------------------|-------------------|
  | **Fire** | Damage/sabotage      | Miri             | Chesy            |
  | **Holy** | Heal/removal         | Priestess        | Lyra             |
  | **Arcane**| Draw/control        | Lyra             | Succubus         |
  | **Nature**| Ramp/creatures      | Chesy            | Miri             |
  | **Shadow**| Sac/drain           | Succubus         | Priestess        |

- **Building Cascade (On Play Any Non-Neutral Card):**
  - If card's element **matches current** → cascade += **card's mana cost** (cap at 10).
  - Else → **reset cascade = card's mana cost**, set current = card's element (cheap switches lose less).
  - **0-cost Cascade Cards:** +0 to cascade (payoff only).
  - Neutral (Echo Crystals): No cascade change.
  - **UI:** Single ProgressBar (0-10) + glowing element icon/color.

- **Upkeep Triggers** (Auto-resolve flavor bonuses, tied to current element; **converts cost 1 mana**):
  - **New:** If cascade = 0, **Scry 3** (look at top 3 cards of library; put them back on top in any order).
  - E.g., "If current=Nature and cascade >=5, +1 mana." "Convert: Switch to Holy, cascade = current/2 (rounded down)" **(costs 1 mana)**.

- **Spending (Main Phase Only):**
  - **Cascade Cards** (0-mana payoffs): Consume X from *current element* → effect + optional *convert* (e.g., "Consume 5 Fire: Deal 10 damage. Convert: Set current=Holy, cascade=3").
  - **Commander Abilities:** E.g., "Spend 4 cascade: Destroy target creature + gain life equal to spent."

- **Alignment Bonus:** 70%+ deck cards in waifu's prim/sec → +[mana cost / 2] extra cascade on matching chains; -1 recast tax.

- **Bleed (Card Effect Only):** Cards apply **Bleed counters** to opponent (e.g., via new effect). **End Step:** Opponent loses 1 cascade per Bleed counter (min 0). Counters fade after 1 full turn or via removal effects.

## Standardized Effect Types
| Effect Name              | Parameters                              | Description / Examples                                                                 | Common Target Modes                  |
|--------------------------|-----------------------------------------|----------------------------------------------------------------------------------------|--------------------------------------|
| **DrawCards**            | amount: int                             | Draw X cards.                                                                          | Player (self)                        |
| **DealDamage**           | amount: int                             | Deal X damage to target.                                                               | Creature (any), Player (opponent), All creatures |
| **DirectDamagePlayer**   | amount: int                             | Deal X damage directly to opponent (bypasses blockers).                                | Player (opponent)                    |
| **GainLife**             | amount: int                             | Gain X life.                                                                           | Player (self)                        |
| **LoseLife**             | amount: int                             | Lose X life.                                                                           | Player (opponent)                    |
| **DestroyTarget**        | —                                       | Destroy target creature (can have conditions).                                         | Creature (any/opponent)              |
| **DestroyAll**           | filter: enum (all, power≤X, etc.)       | Destroy all creatures matching filter.                                                 | All creatures / All opponent         |
| **BuffPowerToughness**   | power_bonus: int, toughness_bonus: int, duration: int | +X/+Y to target(s).                                                                    | Creature (yours / all yours)         |
| **ReducePowerToughness** | power_penalty: int, toughness_penalty: int, duration | -X/-Y debuff.                                                                          | Creature (opponent / all opponent)   |
| **AddKeyword**           | keyword: enum, duration                 | Grant Ethereal / Breakthrough / Endure / Ward X.                                       | Creature (yours / target)            |
| **RemoveKeyword**        | keyword: enum                           | Remove a keyword from target.                                                          | Creature (opponent)                  |
| **GainWard**             | amount: int                             | Target gains Ward X.                                                                   | Creature (yours)                     |
| **ForceDiscard**         | amount: int, random: bool               | Opponent discards X cards (random or chosen).                                          | Player (opponent)                    |
| **Mill**                 | amount: int                             | Opponent mills X cards.                                                                | Player (opponent)                    |
| **CreateToken**          | token_type: string, amount: int         | Create X token creatures.                                                              | — (creates on your side)             |
| **Sacrifice**            | amount: int                             | Sacrifice X of your creatures.                                                         | Creature (yours)                     |
| **ReturnToHand**         | —                                       | Return target to hand.                                                                 | Creature (any)                       |
| **Equip**                | —                                       | Attach this equipment to target creature.                                              | Creature (yours)                     |
| **AuraAttach**           | —                                       | Attach this aura to target (ongoing effect).                                           | Creature (yours / any)               |
| **ConvertCascade**       | new_element: enum, amount: int, retain_pct: int (0-100, optional) | Switch element and set cascade to amount (or retain % of current if pct>0).            | — (affects meter)                    |
| **ModifyCascade**        | amount: int (positive or negative)      | Add or subtract from current cascade (cap 0–10). Negative for penalties.               | — (affects meter)                    |
| **ApplyBleed**           | amount: int                             | Add X Bleed counters to opponent (end step: -1 cascade per counter).                   | Player (opponent)                    |
| **RemoveBleed**          | amount: int                             | Remove X Bleed counters.                                                               | Player (opponent)                    |
| **Scry**                 | amount: int                             | Look at top X cards of library; put them back on top in any order.                     | Player (self)                        |

## Combat Phase (Targeted Blocking – Punch Through)
[Unchanged from previous version]

- **Keywords** (Simple icons):
  | Keyword      | Effect                                      |
  |--------------|---------------------------------------------|
  | **Ethereal** | Can only be blocked by creatures with Ethereal. |
  | **Breakthrough** | Excess damage after lethal to blocker(s) hits life. |
  | **Endure**   | Attacks *and* blocks same turn.             |
  | **Ward X**   | Opponent pays X mana to target it (stackable). |

## Waifu Playstyles (Dual Elements – Commander Examples)
[Unchanged]

## Example Duel: 2 Full Turns (Player: Miri Fire/Nature vs. Opponent: Priestess Holy/Shadow)
[Updated: Starting life 35; Turn1 Upkeep Scry3 example if cascade=0; Echo tap for mana; no auto-bleed.]

## Godot Implementation Notes
- **Echo Crystals:** Persistent on battlefield (Track tapped state; tap signal adds mana).
- **Upkeep Scry:** UI popup: Drag/reorder top3 cards preview.
- **Hand Temp15:** Draw func: hand.size() <=15 before adding; post-draw discard UI if >13.
- **Decks:** Validate max3 Echo on save.
- **Cascade/Bleed UI:** ProgressBar + Bleed icon/counter.
- **Deck Editor:** Non-combat scene (drag-drop, waifu filter, 2-copy/3-Echo limit).


**Balance Notes:** Echo persistent/tap curbs overramp (needs chains for max_mana); Scry3 digs early plays; Life35 accelerates; temp15 smooths draws; upkeep converts (1 mana) strategic.  